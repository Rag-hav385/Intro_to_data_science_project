---
title: "Engine_performance"
output: html_document
date: "2023-10-18"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
data = read.csv('dataset.csv')
data$Cluster = as.character(data$Cluster)
str(data)
```

```{r}
library(ggplot2)
ggplot(data,aes(x=Fuel_mass,y=Cluster)) + geom_boxplot(fill = "#66c2a5", color = "#7570b3") + 
  labs(title = "Fuel Mass across the Clusters",
       x = "Fuel Mass",
       y = "Cluster") +  
  theme_minimal() 
cache=FALSE
```

```{r}
ggplot(data_pre,aes(x=CO..in.g.km..Average..g.km.,y=cluster)) + geom_boxplot(fill = "#66c2a5", color = "#7570b3") + 
  labs(title = "CO..in.g.km..Average..g.km.",
       x = "CO..in.g.km..Average..g.km.",
       y = "Cluster") +  
  theme_minimal() 
cache=FALSE
```

```{r}
ci_list <- list()
confidence_level <- 0.95

# Split the data by cluster and calculate confidence intervals of CO2 for each cluster
for (cluster_id in unique(data_pre$cluster)) {
  subset_data <- data_pre[data_pre$cluster == cluster_id, ]
  
  t_test_result <- t.test(subset_data$CO..in.g.km..Average..g.km., conf.level = confidence_level)
  ci <- t_test_result$conf.int

  ci_list[[as.character(cluster_id)]] <- ci
}
print(ci_list)
```


```{r}
data_pre_c <- data_pre[data_pre$cluster == "2" | data_pre$cluster == "5",]

ggplot(data_pre_c, aes(x = CO..in.g.km..Average..g.km., fill = cluster)) +
  geom_histogram(position = "identity", alpha = 0.4) + 
  scale_x_continuous(limits = c(200, 250))
```

<Observation>
<p>There is a significant left shift in case of Cluster 3 suggesting to maintain Engine.Coolant.Temperature within 218 221 range</p>

Now let's us see how the median of a boxplot behaves for each Clusters in case of **Engine.Coolant.Temperature..C.**

```{r}
ggplot(data_pre,aes(x=Engine.Coolant.Temperature..C.,y=cluster)) + geom_boxplot(fill = "#66c2a5", color = "#7570b3") + 
  labs(title = "Engine Coolant Temperature",
       x = "Engine.Coolant.Temperature..C.",
       y = "Cluster") +  
  theme_minimal() 
cache=FALSE
```

```{r}
ci_list <- list()
confidence_level <- 0.95

# Split the data by cluster and calculate confidence intervals of Engine.Coolant.Temperature..C. for each cluster
for (cluster_id in unique(data_pre$cluster)) {
  subset_data <- data_pre[data_pre$cluster == cluster_id, ]
  
  t_test_result <- t.test(subset_data$Engine.Coolant.Temperature..C., conf.level = confidence_level)
  ci <- t_test_result$conf.int

  ci_list[[as.character(cluster_id)]] <- ci
}
print(ci_list)
```

```{r}
data_pre_c <- data_pre[data_pre$cluster == "2" | data_pre$cluster == "5",]
ggplot(data_pre_c, aes(x = Engine.Coolant.Temperature..C., fill = cluster)) +
  geom_histogram(position = "identity", alpha = 0.4)
```

<Observation>
<p>There is a significant left shift in case of Cluster 1 suggesting to maintain Engine.Coolant.Temperature within 75.8 - 78.2 range</p>

```{r}
ggplot(data_pre,aes(x=Intake.Air.Temperature..C.,y=cluster)) + geom_boxplot(fill = "#66c2a5", color = "#7570b3") + 
  labs(title = "Intake.Air.Temperature..C.",
       x = "Intake.Air.Temperature..C.",
       y = "Cluster") +  
  theme_minimal() 
cache=FALSE
```

```{r}
ci_list <- list()
confidence_level <- 0.95

# Split the data by cluster and calculate confidence intervals of Intake.Air.Temperature..C. for each cluster
for (cluster_id in unique(data_pre$cluster)) {
  subset_data <- data_pre[data_pre$cluster == cluster_id, ]
  
  t_test_result <- t.test(subset_data$Intake.Air.Temperature..C., conf.level = confidence_level)
  ci <- t_test_result$conf.int

  ci_list[[as.character(cluster_id)]] <- ci
}
print(ci_list)
```

```{r}
data_pre_c <- data_pre[data_pre$cluster == "1" | data_pre$cluster == "5",]
ggplot(data_pre_c, aes(x = Intake.Air.Temperature..C., fill = cluster)) +
  geom_histogram(position = "identity", alpha = 0.4)
```


```{r}
ggplot(data_pre,aes(x=Horsepower..At.the.wheels..hp.,y=cluster)) + geom_boxplot(fill = "#66c2a5", color = "#7570b3") + 
  labs(title = "Horsepower..At.the.wheels..hp.",
       x = "Horsepower..At.the.wheels..hp.",
       y = "Cluster") +  
  theme_minimal() 
cache=FALSE
```

```{r}
data_pre_c <- data_pre[data_pre$cluster == "1" | data_pre$cluster == "5",]
ggplot(data_pre_c, aes(x = Horsepower..At.the.wheels..hp., fill = cluster)) +
  geom_histogram(position = "identity", alpha = 0.4)
```

```{r}
ggplot(data_pre,aes(x=Engine.kW..At.the.wheels..kW.,y=cluster)) + geom_boxplot(fill = "#66c2a5", color = "#7570b3") + 
  labs(title = "Engine.kW..At.the.wheels..kW.",
       x = "Engine.kW..At.the.wheels..kW.",
       y = "Cluster") +  
  theme_minimal() 
cache=FALSE
```




